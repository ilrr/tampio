document.onscroll=()=>{let e=document.elementsFromPoint(20,20).find(e=>e.className=="account");let t=document.querySelector("#general-ledger-header .account-info");if(t){t.innerHTML=e?e.querySelector(".account-info").innerHTML:"";t.parentElement.style.backgroundColor=e?getComputedStyle(e.querySelector(".header")).backgroundColor.replace("rgba(0, 0, 0, 0)",""):""}};document.addEventListener("click",e=>{const t=location.hash.slice(1);if(t){const n=document.getElementById(t);if(n&&!n.contains(e.target)){location.hash="ðŸ«¶"}}if(e.target.tagName=="H2"){e.target.parentElement.classList.toggle("hidden")}else if(e.target.classList.contains("name")&&e.target.parentElement.parentElement.classList.contains("header")){const t=e.target.parentElement.parentElement.parentElement;if(t.classList.contains("account")&&!t.classList.contains("leaf")){t.classList.toggle("collapse")}}});document.addEventListener("input",e=>{if(e.target.parentElement.classList.contains("budget"))updateBAccount(e.target)});window.onload=()=>{let e=0;document.querySelectorAll(".budget input").forEach(t=>{const n=e;t.id=`input-${n}`;t.addEventListener("keydown",e=>{if(e.code=="ArrowDown"||e.code=="KeyJ"||e.code=="Enter"||e.code=="NumpadEnter"){e.preventDefault();document.getElementById(`input-${n+2}`).focus()}else if(e.code=="ArrowUp"||e.code=="KeyK"){e.preventDefault();document.getElementById(`input-${n-2}`).focus()}else if(e.code=="KeyL"||t.value==""&&e.code=="ArrowRight"&&n%2==0){e.preventDefault();document.getElementById(`input-${n+1}`).focus()}else if(e.code=="KeyH"||t.value==""&&e.code=="ArrowLeft"&&n%2==1){e.preventDefault();document.getElementById(`input-${n-1}`).focus()}else if(e.code=="KeyX"){e.preventDefault();t.value=""}});e+=1;if(t.value!=""){updateBAccount(t)}})};const updateBAccount=e=>{if(e.value.match(/^\d*[.,]?\d{0,2}$/)){e.classList.remove("bad")}else{e.classList.add("bad")}const t=e.parentElement.parentElement;const n=Number(t.querySelector(".debit input").value.replace(",","."));const c=Number(t.querySelector(".credit input").value.replace(",","."));t.querySelector(".budget.sum").innerText=(c-n).toFixed(2).replace(".",",");t.parentElement.setAttribute("data-rec-credit",c);t.parentElement.setAttribute("data-rec-debit",n);const r=t.parentElement;if(r.classList.contains("account")){updateBAccountFooter(r)}};const updateBAccountFooter=e=>{let t=e.querySelector("& > .header:has(input)");let n=0;let c=0;if(t){c=Number(t.querySelector(".debit input").value.replace(",","."));n=Number(t.querySelector(".credit input").value.replace(",","."))}for(child of e.children){n+=Number(child.getAttribute("data-rec-credit"));c+=Number(child.getAttribute("data-rec-debit"))}e.setAttribute("data-rec-credit",n);e.setAttribute("data-rec-debit",c);const r=e.querySelector("& > .footer");if(r){r.querySelector(".budget.credit").innerText=n.toFixed(2).replace(".",",");r.querySelector(".budget.debit").innerText=c.toFixed(2).replace(".",",");r.querySelector(".budget.sum").innerText=(n-c).toFixed(2).replace(".",",")}const o=e.parentElement;if(o.classList.contains("account")){updateBAccountFooter(o)}};const displayOutput=()=>{const e=document.getElementById("budget-output");e.value="Â§ TALOUSARVIO";for(let t of document.querySelectorAll(".header[id]")){const n=t.id.split("-")[1];const c=t.querySelector("& > .budget.debit input").value.trim();const r=t.querySelector("& > .budget.credit input").value.trim();let o=[];if(c)o.push(c+" DR");if(r)o.push(r+" CR");if(o.length){e.value+=`\n${n}: ${o.join("; ")}`}}document.getElementById("budget-output-container").classList.toggle("hidden")};const hideOutput=()=>{document.getElementById("budget-output-container").classList.toggle("hidden")};